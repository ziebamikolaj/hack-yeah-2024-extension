chrome.tabs.onUpdated.addListener((t,n,r)=>{n.status==="complete"&&r.url&&chrome.tabs.sendMessage(t,{action:"urlChanged",url:r.url})});chrome.runtime.onMessage.addListener((t,n,r)=>{if(t.action==="requestScore")return fetch(`https://is-this-fishy.vercel.app/api/domain/${t.url}`,{method:"GET"}).then(o=>o.text()).then(o=>{if(o==="No domain found"){const e={error:"No domain found"};chrome.runtime.sendMessage({action:"updateScore",error:"No domain found"}),r(e)}else{const e=JSON.parse(o);chrome.runtime.sendMessage({action:"updateScore",score:e.overallScore.toString(),details:e}),r(e)}}).catch(o=>{console.error("Error fetching score:",o);const e={error:"Failed to fetch score"};chrome.runtime.sendMessage({action:"updateScore",error:"Failed to fetch score"}),r(e)}),!0});
